<?xml version="1.0" encoding="utf-8"?>
<Patch>
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneHammer"]</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneHammer"]/weaponTags</xpath>
      <value>
        <li>EgyptianLight</li>
        <li>Toolagri</li>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneSpear"]</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneSpear"]/weaponTags</xpath>
      <value>
        <li>Javiliner</li>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="RangedWeapon_LeatherSling"]</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="RangedWeapon_LeatherSling"]/weaponTags</xpath>
      <value>
        <li>Slinger</li>
        <li>NeolithicRangedBasic</li>
        <li>Barbarian</li>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="RangedWeapon_LeatherSling"]</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="RangedWeapon_LeatherSling"]</xpath>
      <value>
        <generateCommonality Inherit="False">0.4</generateCommonality>
        <!-- The AR Mod series' version is more powerful as well as more common -->
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneAxe"]</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneAxe"]/weaponTags</xpath>
      <value>
        <li>Axe</li>
        <li>WoodcuttingHatchet</li>
        <li>NeolithicMeleeBasic</li>
        <li>Barbarian</li>
        <li>Toolagri</li>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  
  
	<!-- Aelanna's Model No-Match Detector and Insertion Code -->
	<!-- Special thanks to Aelanna for straight-up saving me scores of headaches! -->
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneAxe"]/generateCommonality</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneAxe"]</xpath>
			<success>Always</success>
			<value>
				<generateCommonality>0.4</generateCommonality>
			</value>
		</nomatch>
	</Operation>
  
  
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneAxe"]/generateCommonality</xpath>
    <!-- If it does, do this replacement. -->
    <match Class="PatchOperationReplace">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneAxe"]/generateCommonality</xpath>
      <value>
        <generateCommonality Inherit="False">0.4</generateCommonality>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneSword"]</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneSword"]/weaponTags</xpath>
      <value>
        <li>Axe</li>
        <li>Barbarian</li>
        <li>SimpleSpear</li>
        <li>Knife</li>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneSword"]/generateCommonality</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneSword"]</xpath>
			<success>Always</success>
			<value>
				<generateCommonality>0.3</generateCommonality>
			</value>
		</nomatch>
	</Operation>
  
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneSword"]/generateCommonality</xpath>
    <!-- If it does, do this replacement. -->
    <match Class="PatchOperationReplace">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="MeleeWeapon_StoneSword"]/generateCommonality</xpath>
      <value>
        <generateCommonality Inherit="False">0.3</generateCommonality>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  <!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
  <Operation Class="PatchOperationConditional">
    <xpath>Defs/ThingDef[defName="SimpleWoodenShield"]/description</xpath>
    <nomatch Class="PatchOperationAdd">
      <xpath>Defs/ThingDef[defName="SimpleWoodenShield"]</xpath>
      <success>Always</success>
      <value>
        <description>How is it possible not to have a description?</description>
      </value>
    </nomatch>
  </Operation>
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="SimpleWoodenShield"]/description</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationReplace">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="SimpleWoodenShield"]/description</xpath>
      <value>
        <description>A primitive, a basic shield can be used to offer some protection for low-ranking (and expendable) soldiers. While it can deflect arrows, its usage against bullets is minimal.</description>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="SimpleWoodenShield"]/generateCommonality</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="SimpleWoodenShield"]</xpath>
			<success>Always</success>
			<value>
				<generateCommonality>0.4</generateCommonality>
			</value>
		</nomatch>
	</Operation>
  
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="SimpleWoodenShield"]/generateCommonality</xpath>
    <!-- If it does, do this replacement. -->
    <match Class="PatchOperationReplace">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="SimpleWoodenShield"]/generateCommonality</xpath>
      <value>
        <generateCommonality>0.4</generateCommonality>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="SimpleWoodenShield"]</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="SimpleWoodenShield"]/weaponTags</xpath>
      <value>
        <li>ShieldsOrientLight</li>
        <li>ShieldsPersianLight</li>
        <li>ShieldsGreekLight</li>
        <li>ShieldsNubian</li>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  <!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
  <Operation Class="PatchOperationConditional">
    <xpath>Defs/ThingDef[defName="Maasi"]/description</xpath>
    <nomatch Class="PatchOperationAdd">
      <xpath>Defs/ThingDef[defName="Maasi"]</xpath>
      <success>Always</success>
      <value>
        <description>How is it possible not to have a description?</description>
      </value>
    </nomatch>
  </Operation>
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="Maasi"]/description</xpath>
    <!-- If it does, do this replacement. -->
    <match Class="PatchOperationReplace">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="Maasi"]/description</xpath>
      <value>
        <description>As hideous as it is effective, this ugly shield is common throughout parts of Old Earth's sub-Saharan Africa and has many different names. In southern Africa, it is traditionally made of leather (such as cow hide), while in other parts of the continent, it is made of wood. \n \n On Old Earth, no soldier in the history of Ancient Egypt would be caught dead with something this ugly and simplistic, but the eons separating the Pharaohs of the Rim from their original counterparts led to widespread incorporation of this shield into the arsenal of light skirmishers and low-ranking soldiery.</description>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="Maasi"]</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="Maasi"]</xpath>
      <value>
        <generateCommonality>0.35</generateCommonality>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="Maasi"]/weaponTags</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="Maasi"]/weaponTags</xpath>
      <value>
        <li>ShieldsNubian</li>
        <li>ShieldsMaasi</li>
		<li>ShieldAnkhah</li>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="SimpleWoodenShield"]</xpath>
    <!-- If it does, do this replacement. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/PawnKindDef[defName="SimpleWoodenShield"]/modExtensions/li/shieldTags</xpath>
      <value>
          <li>ShieldsNubian</li>
          <li>ShieldsPersianLight</li>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]/weaponTags</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]</xpath>
			<success>Always</success>
			<value>
				<weaponTags></weaponTags>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]/recipeMaker/researchPrerequisites</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]/recipeMaker</xpath>
			<success>Always</success>
			<value>
				<researchPrerequisites></researchPrerequisites>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]/recipeMaker/researchPrerequisites</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]/recipeMaker</xpath>
			<success>Always</success>
			<value>
				<researchPrerequisites></researchPrerequisites>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_famufu"]/weaponTags</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_famufu"]</xpath>
			<success>Always</success>
			<value>
				<weaponTags></weaponTags>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_famufu"]/recipeMaker/researchPrerequisites</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_famufu"]/recipeMaker</xpath>
			<success>Always</success>
			<value>
				<researchPrerequisites></researchPrerequisites>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]/weaponTags</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]</xpath>
			<success>Always</success>
			<value>
				<weaponTags></weaponTags>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]/recipeMaker/researchPrerequisites</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]/recipeMaker</xpath>
			<success>Always</success>
			<value>
				<researchPrerequisites></researchPrerequisites>
			</value>
		</nomatch>
	</Operation>
  
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]/weaponTags</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName =  "MeleeWeapon_qiang" or defName = "MeleeWeapon_famufu" or defName = "MeleeWeapon_zhanmadao"]/weaponTags</xpath>
      <value>
        <li>Lance</li>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]/weaponTags</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]</xpath>
			<success>Always</success>
			<value>
				<weaponTags></weaponTags>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]/recipeMaker/researchPrerequisites</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]/recipeMaker</xpath>
			<success>Always</success>
			<value>
				<researchPrerequisites></researchPrerequisites>
			</value>
		</nomatch>
	</Operation>
  
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]/weaponTags</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName =  "MeleeWeapon_qiang" or defName = "MeleeWeapon_famufu" or defName = "MeleeWeapon_zhanmadao"]/weaponTags</xpath>
      <value>
        <li>Lance</li>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="MeleeWeapon_famufu"]/weaponTags</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="MeleeWeapon_famufu"]/weaponTags</xpath>
      <value>
        <li>WoodcuttingHatchet</li>
		<li>NeolithicMeleeChief</li>
		<li>NeolithicChief</li>
		<li>Axe</li>
		<li>NeolithicMeleeHeavy</li>
		<li>ClassicalAdvanced</li>
		<li>HellenicMeleeHeavy</li>
		<li>ClassicalAdvanced</li>
		<li>SwordMen</li>
		<li>MedievalMelee</li>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]/weaponTags</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]/weaponTags</xpath>
      <value>
        <li>NeolithicMeleeHeavy</li>
		<li>HorseChopinator</li>
		<li>NeolithicChief</li>
		<li>BeetMelee</li>
		<li>WoodBeetMelee</li>
		<li>PeeledWeapon</li>
		<li>Axe</li>
		<li>LongSword</li>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="MeleeWeapon_feiyan"]/weaponTags</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="MeleeWeapon_feiyan"]/weaponTags</xpath>
      <value>
        <li>MedievalMeleeBasic</li>
		<li>ClassicalMilitary</li>
		<li>Dagger</li>
		<li>RomeSoldier</li>
      </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="MeleeWeapon_sanjiebian"]/weaponTags</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="MeleeWeapon_sanjiebian"]/weaponTags</xpath>
      <value>
        <li>Whip</li>
		<li>WoodBeetMelee</li>
		<li>JeubMelee</li>
		<li>HarrowedMeleeWhip</li>
		<li>CallOfCthulhu_FrenziedCultist</li>
		<li>RWPMelee</li>
	  </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]/weaponTags</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]/weaponTags</xpath>
      <value>
		<li>WoodBeetMelee</li>
		<li>JeubMelee</li>
		<li>CallOfCthulhu_FrenziedCultist</li>
		<li>LongSword</li>
		<li>Sword</li>
	  </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_niuweidao"]/weaponTags</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_niuweidao"]</xpath>
			<success>Always</success>
			<value>
				<weaponTags></weaponTags>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_niuweidao"]/recipeMaker/researchPrerequisites</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_niuweidao"]/recipeMaker</xpath>
			<success>Always</success>
			<value>
				<researchPrerequisites></researchPrerequisites>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]/weaponTags</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]</xpath>
			<success>Always</success>
			<value>
				<weaponTags></weaponTags>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]/recipeMaker/researchPrerequisites</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]/recipeMaker</xpath>
			<success>Always</success>
			<value>
				<researchPrerequisites></researchPrerequisites>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_feiyan"]/weaponTags</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_feiyan"]</xpath>
			<success>Always</success>
			<value>
				<weaponTags></weaponTags>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_feiyan"]/recipeMaker/researchPrerequisites</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_feiyan"]/recipeMaker</xpath>
			<success>Always</success>
			<value>
				<researchPrerequisites></researchPrerequisites>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_sanjiebian"]/weaponTags</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_sanjiebian"]</xpath>
			<success>Always</success>
			<value>
				<weaponTags></weaponTags>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_sanjiebian"]/recipeMaker/researchPrerequisites</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_sanjiebian"]/recipeMaker</xpath>
			<success>Always</success>
			<value>
				<researchPrerequisites></researchPrerequisites>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_gun"]/weaponTags</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_gun"]</xpath>
			<success>Always</success>
			<value>
				<weaponTags></weaponTags>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_gun"]/recipeMaker/researchPrerequisites</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_gun"]/recipeMaker</xpath>
			<success>Always</success>
			<value>
				<researchPrerequisites></researchPrerequisites>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_niuweidao"]/weaponTags</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_niuweidao"]</xpath>
			<success>Always</success>
			<value>
				<weaponTags></weaponTags>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="MeleeWeapon_niuweidao"]/recipeMaker/researchPrerequisites</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="MeleeWeapon_niuweidao"]/recipeMaker</xpath>
			<success>Always</success>
			<value>
				<researchPrerequisites></researchPrerequisites>
			</value>
		</nomatch>
	</Operation>
  
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]</xpath>
		<!-- If it does, LET'S FASTING GOOOOOOOOOO!!! -->
		<match Class="PatchOperationSequence">
			<operations>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]/thingSetMakerTags</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]/recipeMaker/researchPrerequisite</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_famufu"]/thingSetMakerTags</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_famufu"]/recipeMaker/researchPrerequisite</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]/thingSetMakerTags</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]/recipeMaker/researchPrerequisite</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_niuweidao"]/thingSetMakerTags</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_niuweidao"]/recipeMaker/researchPrerequisite</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_gun"]/thingSetMakerTags</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_gun"]/recipeMaker/researchPrerequisite</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_sanjiebian"]/thingSetMakerTags</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_sanjiebian"]/recipeMaker/researchPrerequisite</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_feiyan"]/thingSetMakerTags</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_feiyan"]/recipeMaker/researchPrerequisite</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]/thingSetMakerTags</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]/recipeMaker/researchPrerequisite</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationReplace">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]/recipeMaker/researchPrerequisites</xpath>
					<success>Always</success>
					<value>
						<researchPrerequisites>
							<li>AR_Project_Polearms</li>
							<li MayRequire="sz.tw.new.guohun">TW_Melting</li>
						</researchPrerequisites>
					</value>
				</li>
				<li Class="PatchOperationReplace">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_famufu"]/recipeMaker/researchPrerequisites</xpath>
					<success>Always</success>
					<value>
						<researchPrerequisites>
							<li>AR_Project_Polearms</li>
							<li MayRequire="sz.tw.new.guohun">TW_Melting</li>
						</researchPrerequisites>
					</value>
				</li>
				<li Class="PatchOperationReplace">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]/recipeMaker/researchPrerequisites</xpath>
					<success>Always</success>
					<value>
						<researchPrerequisites>
							<li>AR_Project_Polearms</li>
							<li MayRequire="sz.tw.new.guohun">TW_Melting</li>
						</researchPrerequisites>
					</value>
				</li>
				
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]/costList</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]/costStuffCount</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_famufu"]/costList</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_famufu"]/costStuffCount</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]/costList</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]/costStuffCount</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_niuweidao"]/costList</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_niuweidao"]/costStuffCount</xpath>
					<success>Always</success>
				</li>
				
				<!-- 
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_gun"]/costList</xpath>
					<success>Always</success>
				</li>
				
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_gun"]/costStuffCount</xpath>
					<success>Always</success>
				</li>
				-->
				
				<!--
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_sanjiebian"]/costList</xpath>
					<success>Always</success>
				</li>
				
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_sanjiebian"]/costStuffCount</xpath>
					<success>Always</success>
				</li>
				-->
				
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_feiyan"]/costList</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_feiyan"]/costStuffCount</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]/costList</xpath>
					<success>Always</success>
				</li>
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]/costStuffCount</xpath>
					<success>Always</success>
				</li>
				
				
				
				
				

				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]/stuffCategories</xpath>
					<success>Always</success>
				</li>

				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_famufu"]/stuffCategories</xpath>
					<success>Always</success>
				</li>
				
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]/stuffCategories</xpath>
					<success>Always</success>
				</li>

				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_niuweidao"]/stuffCategories</xpath>
					<success>Always</success>
				</li>

				<!--
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_gun"]/stuffCategories</xpath>
					<success>Always</success>
				</li>
				-->

				<!--
				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_sanjiebian"]/stuffCategories</xpath>
					<success>Always</success>
				</li>				
				-->

				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_feiyan"]/stuffCategories</xpath>
					<success>Always</success>
				</li>

				<li Class="PatchOperationRemove">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]/stuffCategories</xpath>
					<success>Always</success>
				</li>
				
				<li Class="PatchOperationAdd">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_zhanmadao"]</xpath>
					<success>Always</success>
					<value>
						<costStuffCount>180</costStuffCount>
						<stuffCategories>
							<li>Metallic</li>
							<li>Stony</li>

							<!-- Support for Mod Stuff -->
							<li MayRequire="Dubwise.Rimefeller">Plastic</li>
							<li MayRequire="Dubwise.Rimefeller">Composite</li>
							<li MayRequire="sarg.alphabiomes">AB_ExoticMetals</li>
							<li MayRequire="biomesteam.biomescore">BMT_ChitinStuff</li>
							<li MayRequire="eltwofour.mantodeanrace">MantodeanOrganic</li>
						</stuffCategories>
						<costList></costList>
					</value>
				</li>
				<li Class="PatchOperationAdd">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_qiang"]</xpath>
					<success>Always</success>
					<value>
						<costStuffCount>200</costStuffCount>
						<stuffCategories>
							<li>Metallic</li>
							<li>Stony</li>

							<!-- Support for Mod Stuff -->
							<li MayRequire="Dubwise.Rimefeller">Plastic</li>
							<li MayRequire="Dubwise.Rimefeller">Composite</li>
							<li MayRequire="sarg.alphabiomes">AB_ExoticMetals</li>
							<li MayRequire="biomesteam.biomescore">BMT_ChitinStuff</li>
							<li MayRequire="eltwofour.mantodeanrace">MantodeanOrganic</li>
						</stuffCategories>
						<costList></costList>
					</value>
				</li>
				<li Class="PatchOperationAdd">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_feiyan"]</xpath>
					<success>Always</success>
					<value>
						<costStuffCount>105</costStuffCount>
						<stuffCategories>
							<li>Metallic</li>
							<li>Stony</li>

							<!-- Support for Mod Stuff -->
							<li MayRequire="Dubwise.Rimefeller">Plastic</li>
							<li MayRequire="Dubwise.Rimefeller">Composite</li>
							<li MayRequire="sarg.alphabiomes">AB_ExoticMetals</li>
							<li MayRequire="biomesteam.biomescore">BMT_ChitinStuff</li>
							<li MayRequire="eltwofour.mantodeanrace">MantodeanOrganic</li>
						</stuffCategories>
						<costList></costList>
					</value>
				</li>
				<li Class="PatchOperationReplace">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_feiyan"]/recipeMaker/researchPrerequisites</xpath>
					<success>Always</success>
					<value>
						<researchPrerequisites>
							<!-- <li>AR_Project_Polearms</li> -->
							<li MayRequire="sz.tw.new.guohun">TW_Melting</li>
						</researchPrerequisites>
					</value>
				</li>
				<li Class="PatchOperationAdd">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]</xpath>
					<success>Always</success>
					<value>
						<costStuffCount>185</costStuffCount>
						<stuffCategories>
							<li>Metallic</li>
							<li>Stony</li>

							<!-- Support for Mod Stuff -->
							<li MayRequire="Dubwise.Rimefeller">Plastic</li>
							<li MayRequire="Dubwise.Rimefeller">Composite</li>
							<li MayRequire="sarg.alphabiomes">AB_ExoticMetals</li>
							<li MayRequire="biomesteam.biomescore">BMT_ChitinStuff</li>
							<li MayRequire="eltwofour.mantodeanrace">MantodeanOrganic</li>
						</stuffCategories>
						<costList></costList>
					</value>
				</li>
				<li Class="PatchOperationReplace">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]/recipeMaker/researchPrerequisites</xpath>
					<success>Always</success>
					<value>
						<researchPrerequisites>
							<!-- <li>AR_Project_Polearms</li> -->
							<li>LongBlades</li>
							<li MayRequire="sz.tw.new.guohun">TW_Melting</li>
						</researchPrerequisites>
					</value>
				</li>
				<li Class="PatchOperationAdd">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]</xpath>
					<success>Always</success>
					<value>
						<costStuffCount>185</costStuffCount>
						<stuffCategories>
							<li>Metallic</li>
							<li>Stony</li>

							<!-- Support for Mod Stuff -->
							<li MayRequire="Dubwise.Rimefeller">Plastic</li>
							<li MayRequire="Dubwise.Rimefeller">Composite</li>
							<li MayRequire="sarg.alphabiomes">AB_ExoticMetals</li>
							<li MayRequire="biomesteam.biomescore">BMT_ChitinStuff</li>
							<li MayRequire="eltwofour.mantodeanrace">MantodeanOrganic</li>
						</stuffCategories>
						<costList>
							<Gold>5</Gold>
						</costList>
					</value>
				</li>
				<li Class="PatchOperationReplace">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_yanyuedao"]/recipeMaker/researchPrerequisites</xpath>
					<success>Always</success>
					<value>
						<researchPrerequisites>
							<!-- <li>AR_Project_Polearms</li> -->
							<li>LongBlades</li>
							<li MayRequire="sz.tw.new.guohun">TW_Melting</li>
						</researchPrerequisites>
					</value>
				</li>
				<li Class="PatchOperationAdd">
					<xpath>/Defs/ThingDef[defName = "MeleeWeapon_sanjiebian" or defName = "MeleeWeapon_gun"]/stuffCategories</xpath>
					<success>Always</success>
					<value>
						<li>Fabric</li>
						<li>Leathery</li>
					</value>
				</li>
				<li Class="PatchOperationReplace">
					<xpath>/Defs/ThingDef[defName="MeleeWeapon_gun"]/recipeMaker/researchPrerequisites</xpath>
					<success>Always</success>
					<value>
						<researchPrerequisites>
							<!-- <li>AR_Project_Polearms</li> -->
							<li>LongBlades</li>
							<li MayRequire="sz.tw.new.guohun">TW_Melting</li>
						</researchPrerequisites>
					</value>
				</li>
			</operations>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="CGMeleeWeapon_Partisan"]/weaponTags</xpath>
    <!-- If it does, add this. -->
    <match Class="PatchOperationAdd">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="CGMeleeWeapon_Partisan"]/weaponTags</xpath>
      <value>
        <li>Lance</li>
		<li>SpearMen</li>
	  </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
  
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>/Defs/ThingDef[defName="CGMeleeWeapon_Partisan"]/recipeMaker/researchPrerequisite</xpath>
    <!-- If it does, do this replacement. -->
    <match Class="PatchOperationReplace">
      <success>Always</success>
      <xpath>/Defs/ThingDef[defName="CGMeleeWeapon_Partisan"]/recipeMaker/researchPrerequisite</xpath>
      <value>
			<researchPrerequisites>
				<li>AR_Project_Polearms</li>
			</researchPrerequisites>
	  </value>
    </match>
    <!-- If the first XPATH does not exist, the original code stands. -->
  </Operation>
</Patch>